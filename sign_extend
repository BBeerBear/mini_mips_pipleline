library IEEE;
use IEEE.std_logic_1164.all;

entity sign_extend is
  port (
    data_in   : in  std_logic_vector(15 downto 0); -- Input data to be sign-extended
    width     : in  integer range 0 to 31;         -- Number of bits to extend to
    data_out  : out std_logic_vector(31 downto 0)  -- Output sign-extended data
  );
end sign_extend;

architecture Behavioral of sign_extend is
begin
  process (data_in, width)
  begin
    if data_in(15) = '1' then        -- If MSB is 1 (negative number)
      data_out <= (others => '1');   -- Fill the output with 1's
      data_out(width downto 16) <= data_in; -- Copy the input data to the output
    else
      data_out <= (others => '0');   -- Fill the output with 0's
      data_out(width downto 16) <= data_in; -- Copy the input data to the output
    end if;
  end process;
end Behavioral;
